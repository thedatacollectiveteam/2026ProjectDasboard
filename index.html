<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Data Collective 2026 Project Dashboard</title>
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;600;700&family=Archivo+Black&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-dark: #0d0d0d;
            --bg-medium: #1a1a1a;
            --bg-card: #242424;
            --accent-cyan: #00ffcc;
            --accent-orange: #ff6b35;
            --accent-purple: #b565d8;
            --text-primary: #ffffff;
            --text-secondary: #8a8a8a;
            --green: #00ff88;
            --yellow: #ffd700;
            --red: #ff3366;
            --border: #2a2a2a;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'IBM Plex Mono', monospace;
            background: var(--bg-dark);
            color: var(--text-primary);
            line-height: 1.6;
        }

        .container {
            max-width: 1800px;
            margin: 0 auto;
            padding: 30px;
        }

        header {
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 3px solid var(--accent-cyan);
        }

        h1 {
            font-family: 'Archivo Black', sans-serif;
            font-size: 3.5rem;
            letter-spacing: 3px;
            color: var(--accent-cyan);
            margin-bottom: 10px;
            text-transform: uppercase;
        }

        .subtitle {
            font-size: 1rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .sidebar {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .stat-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            padding: 20px;
            border-left: 4px solid var(--accent-cyan);
        }

        .stat-label {
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            color: var(--text-secondary);
            margin-bottom: 8px;
        }

        .stat-value {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--accent-cyan);
        }

        .stat-subtext {
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin-top: 8px;
        }

        .filters {
            background: var(--bg-card);
            border: 1px solid var(--border);
            padding: 20px;
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .filter-label {
            font-size: 0.7rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--text-secondary);
        }

        select, input {
            background: var(--bg-dark);
            border: 1px solid var(--border);
            color: var(--text-primary);
            padding: 8px 12px;
            font-family: 'IBM Plex Mono', monospace;
            font-size: 0.85rem;
        }

        select:focus, input:focus {
            outline: none;
            border-color: var(--accent-cyan);
        }

        .main-content {
            display: flex;
            flex-direction: column;
            gap: 30px;
        }

        .section {
            background: var(--bg-card);
            border: 1px solid var(--border);
            padding: 25px;
        }

        .section-header {
            font-size: 1.3rem;
            font-weight: 700;
            letter-spacing: 2px;
            margin-bottom: 20px;
            color: var(--accent-orange);
            text-transform: uppercase;
            padding-bottom: 12px;
            border-bottom: 2px solid var(--border);
        }

        .upcoming-milestones {
            display: grid;
            gap: 12px;
        }

        .milestone-item {
            background: var(--bg-dark);
            border-left: 3px solid var(--accent-purple);
            padding: 15px;
            display: grid;
            grid-template-columns: 120px 1fr 100px;
            gap: 15px;
            align-items: center;
        }

        .milestone-date {
            font-weight: 700;
            color: var(--accent-purple);
            font-size: 0.9rem;
        }

        .milestone-info {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .milestone-client {
            font-weight: 600;
            color: var(--text-primary);
        }

        .milestone-phase {
            font-size: 0.85rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .milestone-status {
            padding: 4px 10px;
            font-size: 0.7rem;
            font-weight: 700;
            text-align: center;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .projects-table {
            width: 100%;
            border-collapse: collapse;
        }

        .projects-table th {
            background: var(--bg-dark);
            padding: 12px;
            text-align: left;
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--text-secondary);
            border-bottom: 2px solid var(--border);
        }

        .projects-table td {
            padding: 15px 12px;
            border-bottom: 1px solid var(--border);
            font-size: 0.9rem;
        }

        .projects-table tr {
            transition: background 0.2s ease;
        }

        .projects-table tr:hover {
            background: var(--bg-dark);
        }

        .project-name-cell {
            font-weight: 600;
            color: var(--text-primary);
        }

        .status-indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 8px;
        }

        .status-green { background: var(--green); }
        .status-yellow { background: var(--yellow); }
        .status-red { background: var(--red); }

        .phase-badge {
            display: inline-block;
            padding: 4px 10px;
            background: var(--bg-dark);
            border: 1px solid var(--accent-cyan);
            color: var(--accent-cyan);
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: 600;
        }

        .phase-badge.planning { border-color: var(--text-secondary); color: var(--text-secondary); }
        .phase-badge.test1 { border-color: #4a9eff; color: #4a9eff; }
        .phase-badge.test2 { border-color: #00bfff; color: #00bfff; }
        .phase-badge.test3 { border-color: #00d4ff; color: #00d4ff; }
        .phase-badge.production { border-color: var(--accent-orange); color: var(--accent-orange); }
        .phase-badge.refresh { border-color: var(--accent-purple); color: var(--accent-purple); }
        .phase-badge.complete { border-color: var(--green); color: var(--green); }

        .team-list {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        .complexity-dots {
            display: flex;
            gap: 3px;
        }

        .complexity-dot {
            width: 8px;
            height: 8px;
            background: var(--accent-cyan);
            border-radius: 50%;
        }

        .date-cell {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        .no-data {
            text-align: center;
            padding: 40px;
            color: var(--text-secondary);
            font-style: italic;
        }

        footer {
            margin-top: 40px;
            padding: 20px;
            text-align: center;
            border-top: 1px solid var(--border);
            color: var(--text-secondary);
            font-size: 0.85rem;
        }

        @media (max-width: 1200px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
            
            .milestone-item {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>DATA COLLECTIVE</h1>
            <div class="subtitle">2026 Project Dashboard // Tier 1 Import Support</div>
        </header>

        <div class="dashboard-grid">
            <div class="sidebar">
                <div class="stat-card">
                    <div class="stat-label">Total Projects</div>
                    <div class="stat-value" id="totalProjects">0</div>
                    <div class="stat-subtext">Across 2026-2027</div>
                </div>
                
                <div class="stat-card" style="border-left-color: var(--green);">
                    <div class="stat-label">Green Status</div>
                    <div class="stat-value" id="greenCount" style="color: var(--green);">0</div>
                    <div class="stat-subtext">On track</div>
                </div>
                
                <div class="stat-card" style="border-left-color: var(--yellow);">
                    <div class="stat-label">Yellow Status</div>
                    <div class="stat-value" id="yellowCount" style="color: var(--yellow);">0</div>
                    <div class="stat-subtext">At risk</div>
                </div>
                
                <div class="stat-card" style="border-left-color: var(--red);">
                    <div class="stat-label">Red Status</div>
                    <div class="stat-value" id="redCount" style="color: var(--red);">0</div>
                    <div class="stat-subtext">Critical</div>
                </div>

                <div class="filters">
                    <div class="filter-group">
                        <label class="filter-label">Status</label>
                        <select id="statusFilter">
                            <option value="">All</option>
                            <option value="Green">Green</option>
                            <option value="Yellow">Yellow</option>
                            <option value="Red">Red</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label class="filter-label">Team Member</label>
                        <select id="teamFilter">
                            <option value="">All</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label class="filter-label">Search</label>
                        <input type="text" id="searchInput" placeholder="Client...">
                    </div>
                </div>
            </div>

            <div class="main-content">
                <div class="section">
                    <div class="section-header">âš¡ Upcoming Milestones (Next 90 Days)</div>
                    <div class="upcoming-milestones" id="upcomingMilestones"></div>
                </div>

                <div class="section">
                    <div class="section-header">ðŸ“Š All Projects</div>
                    <div style="overflow-x: auto;">
                        <table class="projects-table">
                            <thead>
                                <tr>
                                    <th>Client</th>
                                    <th>Status</th>
                                    <th>Current Phase</th>
                                    <th>Live Date</th>
                                    <th>Complexity</th>
                                    <th>Team</th>
                                </tr>
                            </thead>
                            <tbody id="projectsTableBody"></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <footer>
            <strong>THE DATA COLLECTIVE</strong> // bswift Tier 1 Import Support Team<br>
            Last Updated: <span id="lastUpdated"></span>
        </footer>
    </div>

    <script>
<<<<<<< HEAD
const projectsData = [{"Client Name":"Saltchuk ACA","Shard":"S","Complexity":"5","Data People":"Rafa\nTimo","Live Date":"12/31/25","Overall Status":"Green","Flagged Status Reason":"","On Red Issues Log":"","Supp SQL":"","Loop Arounds":"","Test 1 Begin":"","Test 1 End":"","Test 2 Begin":"","Test 2 End":"","Test 3 Begin":"","Test 3 End":"","Production Begin":"","Production End":"","Refresh Begin":"","Refresh End":"","Modified Date":"01/15/26 8:26 AM"},{"Client Name":"OSG/Tote","Shard":"S","Complexity":"3","Data People":"Kevin\nTimo","Live Date":"12/31/25","Overall Status":"Green","Flagged Status Reason":"","On Red Issues Log":"","Supp SQL":"","Loop Arounds":"","Test 1 Begin":"","Test 1 End":"","Test 2 Begin":"","Test 2 End":"","Test 3 Begin":"","Test 3 End":"","Production Begin":"","Production End":"","Refresh Begin":"","Refresh End":"","Modified Date":"12/03/25 7:59 AM"},{"Client Name":"Logan\u0027s Roadhouse","Shard":"I","Complexity":"3","Data People":"Kevin\nTimo","Live Date":"02/01/26","Overall Status":"Red","Flagged Status Reason":"Client delay","On Red Issues Log":"TRUE","Supp SQL":"","Loop Arounds":"","Test 1 Begin":"","Test 1 End":"","Test 2 Begin":"","Test 2 End":"","Test 3 Begin":"","Test 3 End":"","Production Begin":"","Production End":"","Refresh Begin":"","Refresh End":"","Modified Date":"01/20/26 3:09 PM"},{"Client Name":"Vail Resorts","Shard":"V","Complexity":"4","Data People":"Rafa\nSam","Live Date":"03/02/26","Overall Status":"Yellow","Flagged Status Reason":"","On Red Issues Log":"","Supp SQL":"","Loop Arounds":"","Test 1 Begin":"10/27/25","Test 1 End":"11/07/25","Test 2 Begin":"12/02/25","Test 2 End":"12/18/25","Test 3 Begin":"","Test 3 End":"","Production Begin":"01/20/26","Production End":"02/03/26","Refresh Begin":"02/17/26","Refresh End":"02/25/26","Modified Date":"01/23/26 11:15 AM"},{"Client Name":"Insperity Phase 2","Shard":"AE","Complexity":"5","Data People":"Kevin","Live Date":"04/01/26","Overall Status":"Green","Flagged Status Reason":"","On Red Issues Log":"","Supp SQL":"","Loop Arounds":"","Test 1 Begin":"","Test 1 End":"","Test 2 Begin":"","Test 2 End":"","Test 3 Begin":"","Test 3 End":"","Production Begin":"01/12/26","Production End":"01/28/26","Refresh Begin":"02/27/26","Refresh End":"03/05/26","Modified Date":"12/15/25 7:37 AM"},{"Client Name":"Construction Resources","Shard":"YY","Complexity":"3","Data People":"Sam\nTimi","Live Date":"04/01/26","Overall Status":"Green","Flagged Status Reason":"","On Red Issues Log":"","Supp SQL":"","Loop Arounds":"","Test 1 Begin":"01/26/26","Test 1 End":"02/09/26","Test 2 Begin":"","Test 2 End":"","Test 3 Begin":"","Test 3 End":"","Production Begin":"03/02/26","Production End":"03/12/26","Refresh Begin":"03/23/26","Refresh End":"03/25/26","Modified Date":"01/07/26 11:29 AM"},{"Client Name":"Brookdale","Shard":"AB","Complexity":"3","Data People":"Cameron\nRafa\nSam","Live Date":"05/01/26","Overall Status":"Yellow","Flagged Status Reason":"Contract Delay","On Red Issues Log":"TRUE","Supp SQL":"","Loop Arounds":"","Test 1 Begin":"01/26/26","Test 1 End":"02/09/26","Test 2 Begin":"02/25/26","Test 2 End":"03/11/26","Test 3 Begin":"","Test 3 End":"","Production Begin":"03/26/26","Production End":"04/07/26","Refresh Begin":"05/05/26","Refresh End":"05/11/26","Modified Date":"01/23/26 10:59 AM"},{"Client Name":"UMMS [University of Maryland]","Shard":"YY","Complexity":"3","Data People":"Cameron\nRafa\nShema\nTimo","Live Date":"05/01/26","Overall Status":"Red","Flagged Status Reason":"Contract Delay","On Red Issues Log":"TRUE","Supp SQL":"","Loop Arounds":"","Test 1 Begin":"","Test 1 End":"","Test 2 Begin":"03/13/26","Test 2 End":"03/27/26","Test 3 Begin":"","Test 3 End":"","Production Begin":"04/24/26","Production End":"05/08/26","Refresh Begin":"","Refresh End":"","Modified Date":"01/30/26 12:20 PM"},{"Client Name":"Dicks Sporting Goods","Shard":"Z","Complexity":"4","Data People":"Kevin\nSam","Live Date":"06/01/26","Overall Status":"Green","Flagged Status Reason":"","On Red Issues Log":"","Supp SQL":"","Loop Arounds":"","Test 1 Begin":"03/23/26","Test 1 End":"04/07/26","Test 2 Begin":"04/30/26","Test 2 End":"05/13/26","Test 3 Begin":"","Test 3 End":"","Production Begin":"06/01/26","Production End":"06/10/26","Refresh Begin":"06/22/26","Refresh End":"06/24/26","Modified Date":"01/30/26 2:18 AM"},{"Client Name":"Pulte Group","Shard":"","Complexity":"3","Data People":"Jessica\nKevin","Live Date":"06/01/26","Overall Status":"Green","Flagged Status Reason":"","On Red Issues Log":"","Supp SQL":"","Loop Arounds":"","Test 1 Begin":"03/09/26","Test 1 End":"03/18/26","Test 2 Begin":"04/10/26","Test 2 End":"04/20/26","Test 3 Begin":"","Test 3 End":"","Production Begin":"05/06/26","Production End":"05/12/26","Refresh Begin":"","Refresh End":"","Modified Date":"01/30/26 2:18 AM"},{"Client Name":"Tractor Supply","Shard":"V","Complexity":"2","Data People":"Cameron\nRafa\nShema\nTimo","Live Date":"06/08/26","Overall Status":"Red","Flagged Status Reason":"Contract Delay","On Red Issues Log":"","Supp SQL":"","Loop Arounds":"","Test 1 Begin":"01/22/26","Test 1 End":"02/09/26","Test 2 Begin":"03/03/26","Test 2 End":"03/16/26","Test 3 Begin":"","Test 3 End":"","Production Begin":"05/13/26","Production End":"05/25/26","Refresh Begin":"","Refresh End":"","Modified Date":"01/30/26 1:10 PM"},{"Client Name":"Sun Life","Shard":"V","Complexity":"3","Data People":"Kevin\nShema\nTimo","Live Date":"07/01/26","Overall Status":"Red","Flagged Status Reason":"Contract Delay","On Red Issues Log":"TRUE","Supp SQL":"","Loop Arounds":"","Test 1 Begin":"","Test 1 End":"","Test 2 Begin":"03/06/26","Test 2 End":"04/14/26","Test 3 Begin":"","Test 3 End":"","Production Begin":"05/26/26","Production End":"06/29/26","Refresh Begin":"","Refresh End":"","Modified Date":"01/30/26 12:20 PM"},{"Client Name":"Dentsply","Shard":"AB","Complexity":"3","Data People":"Cameron\nRafa\nShema\nTimo","Live Date":"07/01/26","Overall Status":"Green","Flagged Status Reason":"","On Red Issues Log":"","Supp SQL":"","Loop Arounds":"","Test 1 Begin":"03/05/26","Test 1 End":"03/20/26","Test 2 Begin":"04/15/26","Test 2 End":"04/28/26","Test 3 Begin":"","Test 3 End":"","Production Begin":"05/26/26","Production End":"06/04/26","Refresh Begin":"07/06/26","Refresh End":"07/10/26","Modified Date":"01/08/26 8:36 AM"},{"Client Name":"DTCC [Trust \u0026 Clearning]","Shard":"YY","Complexity":"3","Data People":"Sam\nTimi","Live Date":"07/01/26","Overall Status":"Green","Flagged Status Reason":"","On Red Issues Log":"","Supp SQL":"","Loop Arounds":"","Test 1 Begin":"03/24/26","Test 1 End":"04/08/26","Test 2 Begin":"04/27/26","Test 2 End":"05/08/26","Test 3 Begin":"","Test 3 End":"","Production Begin":"05/27/26","Production End":"06/05/26","Refresh Begin":"06/22/26","Refresh End":"06/24/26","Modified Date":"01/15/26 8:50 AM"},{"Client Name":"Grant Thorton","Shard":"V","Complexity":"3","Data People":"Jessica\nKevin","Live Date":"07/01/26","Overall Status":"Green","Flagged Status Reason":"","On Red Issues Log":"","Supp SQL":"","Loop Arounds":"","Test 1 Begin":"03/12/26","Test 1 End":"03/20/26","Test 2 Begin":"04/20/26","Test 2 End":"05/04/26","Test 3 Begin":"","Test 3 End":"","Production Begin":"06/01/26","Production End":"06/10/26","Refresh Begin":"06/25/26","Refresh End":"06/26/26","Modified Date":"12/24/25 7:31 AM"},{"Client Name":"Lear","Shard":"Z","Complexity":"4","Data People":"Jessica\nKevin","Live Date":"08/03/26","Overall Status":"Green","Flagged Status Reason":"","On Red Issues Log":"","Supp SQL":"","Loop Arounds":"","Test 1 Begin":"03/23/26","Test 1 End":"04/15/26","Test 2 Begin":"05/18/26","Test 2 End":"06/02/26","Test 3 Begin":"","Test 3 End":"","Production Begin":"07/01/26","Production End":"07/16/26","Refresh Begin":"07/23/26","Refresh End":"07/28/26","Modified Date":"12/24/25 7:31 AM"},{"Client Name":"DTE","Shard":"N","Complexity":"4","Data People":"Sam\nTimi","Live Date":"10/01/26","Overall Status":"Green","Flagged Status Reason":"","On Red Issues Log":"","Supp SQL":"","Loop Arounds":"","Test 1 Begin":"03/17/26","Test 1 End":"04/07/26","Test 2 Begin":"05/19/26","Test 2 End":"06/09/26","Test 3 Begin":"07/13/26","Test 3 End":"07/31/26","Production Begin":"09/01/26","Production End":"09/15/26","Refresh Begin":"","Refresh End":"","Modified Date":"12/24/25 7:31 AM"},{"Client Name":"Optavise","Shard":"","Complexity":"5","Data People":"Cameron\nJessica\nKevin\nShema\nTimo","Live Date":"12/31/26","Overall Status":"Green","Flagged Status Reason":"","On Red Issues Log":"","Supp SQL":"","Loop Arounds":"","Test 1 Begin":"","Test 1 End":"","Test 2 Begin":"","Test 2 End":"","Test 3 Begin":"","Test 3 End":"","Production Begin":"","Production End":"","Refresh Begin":"","Refresh End":"","Modified Date":"01/08/26 11:00 AM"},{"Client Name":"","Shard":"","Complexity":"","Data People":"","Live Date":"","Overall Status":"","Flagged Status Reason":"","On Red Issues Log":"","Supp SQL":"","Loop Arounds":"","Test 1 Begin":"","Test 1 End":"","Test 2 Begin":"","Test 2 End":"","Test 3 Begin":"","Test 3 End":"","Production Begin":"","Production End":"","Refresh Begin":"","Refresh End":"","Modified Date":""}]]; = [...projectsData];
>>>>>>> b86d0afcfef0873464f9c04b087656602d0924a1

        function parseDate(dateString) {
            if (!dateString) return null;
            // Parse the date string as local time, not UTC
            // This prevents timezone conversion from shifting dates
            const [year, month, day] = dateString.split('-').map(Number);
            return new Date(year, month - 1, day);
        }

        function formatDate(dateString) {
            if (!dateString) return 'TBD';
            const date = parseDate(dateString);
            if (!date) return 'TBD';
            return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });
        }

        function parseTeamMembers(dataString) {
            if (!dataString || dataString === 'null' || dataString === null) return [];
            return dataString.split('\\n').map(name => name.trim()).filter(name => name);
        }

        function getCurrentPhase(project) {
            const now = new Date();
            
            if (project['Refresh End'] && parseDate(project['Refresh End']) < now) {
                return { phase: 'complete', label: 'Complete' };
            }
            if (project['Refresh Begin'] && parseDate(project['Refresh Begin']) <= now) {
                return { phase: 'refresh', label: 'Refresh' };
            }
            if (project['Production End'] && parseDate(project['Production End']) < now) {
                return { phase: 'refresh', label: 'Pre-Refresh' };
            }
            if (project['Production Begin'] && parseDate(project['Production Begin']) <= now) {
                return { phase: 'production', label: 'Production' };
            }
            if (project['Test 3 Begin'] && parseDate(project['Test 3 Begin']) <= now) {
                return { phase: 'test3', label: 'Test 3' };
            }
            if (project['Test 2 Begin'] && parseDate(project['Test 2 Begin']) <= now) {
                return { phase: 'test2', label: 'Test 2' };
            }
            if (project['Test 1 Begin'] && parseDate(project['Test 1 Begin']) <= now) {
                return { phase: 'test1', label: 'Test 1' };
            }
            
            return { phase: 'planning', label: 'Planning' };
        }

        function getUpcomingMilestones() {
            const now = new Date();
            const ninetyDaysOut = new Date(now.getTime() + (90 * 24 * 60 * 60 * 1000));
            const milestones = [];

            filteredProjects.forEach(project => {
                const phases = [
                    { date: project['Test 1 Begin'], label: 'Test 1 Begins', type: 'test' },
                    { date: project['Test 1 End'], label: 'Test 1 Ends', type: 'test' },
                    { date: project['Test 2 Begin'], label: 'Test 2 Begins', type: 'test' },
                    { date: project['Test 2 End'], label: 'Test 2 Ends', type: 'test' },
                    { date: project['Test 3 Begin'], label: 'Test 3 Begins', type: 'test' },
                    { date: project['Test 3 End'], label: 'Test 3 Ends', type: 'test' },
                    { date: project['Production Begin'], label: 'Production Begins', type: 'production' },
                    { date: project['Production End'], label: 'Production Ends', type: 'production' },
                    { date: project['Refresh Begin'], label: 'Refresh Begins', type: 'refresh' },
                    { date: project['Refresh End'], label: 'Refresh Ends', type: 'refresh' },
                    { date: project['Live Date'], label: 'Go Live', type: 'live' }
                ];

                phases.forEach(phase => {
                    if (phase.date) {
                        const phaseDate = parseDate(phase.date);
                        if (phaseDate >= now && phaseDate <= ninetyDaysOut) {
                            milestones.push({
                                date: phaseDate,
                                dateString: phase.date,
                                client: project['Client Name'],
                                phase: phase.label,
                                status: project['Overall Status'],
                                type: phase.type
                            });
                        }
                    }
                });
            });

            return milestones.sort((a, b) => a.date - b.date);
        }

        function renderUpcomingMilestones() {
            const container = document.getElementById('upcomingMilestones');
            const milestones = getUpcomingMilestones();

            if (milestones.length === 0) {
                container.innerHTML = '<div class="no-data">No milestones in the next 90 days</div>';
                return;
            }

            container.innerHTML = milestones.map(m => `
                <div class="milestone-item">
                    <div class="milestone-date">${formatDate(m.dateString)}</div>
                    <div class="milestone-info">
                        <div class="milestone-client">${m.client}</div>
                        <div class="milestone-phase">${m.phase}</div>
                    </div>
                    <div class="milestone-status" style="background: var(--${m.status.toLowerCase()}); color: var(--bg-dark);">
                        ${m.status}
                    </div>
                </div>
            `).join('');
        }

        function renderProjectsTable() {
            const tbody = document.getElementById('projectsTableBody');
            
            if (filteredProjects.length === 0) {
                tbody.innerHTML = '<tr><td colspan="6" class="no-data">No projects match your filters</td></tr>';
                return;
            }

            tbody.innerHTML = filteredProjects.map(project => {
                const status = project['Overall Status'] || 'Green';
                const phase = getCurrentPhase(project);
                const teamMembers = parseTeamMembers(project['Data People']);
                const complexity = project.Complexity;

                return `
                    <tr>
                        <td class="project-name-cell">${project['Client Name']}</td>
                        <td>
                            <span class="status-indicator status-${status.toLowerCase()}"></span>
                            ${status}
                        </td>
                        <td>
                            <span class="phase-badge ${phase.phase}">${phase.label}</span>
                        </td>
                        <td class="date-cell">${formatDate(project['Live Date'])}</td>
                        <td>
                            ${complexity ? `
                                <div class="complexity-dots">
                                    ${Array(Math.floor(complexity)).fill('<div class="complexity-dot"></div>').join('')}
                                </div>
                            ` : '<span style="color: var(--text-secondary);">N/A</span>'}
                        </td>
                        <td class="team-list">
                            ${teamMembers.length > 0 ? teamMembers.join(', ') : 'Unassigned'}
                        </td>
                    </tr>
                `;
            }).join('');
        }

        function updateStats() {
            document.getElementById('totalProjects').textContent = filteredProjects.length;
            document.getElementById('greenCount').textContent = filteredProjects.filter(p => p['Overall Status'] === 'Green').length;
            document.getElementById('yellowCount').textContent = filteredProjects.filter(p => p['Overall Status'] === 'Yellow').length;
            document.getElementById('redCount').textContent = filteredProjects.filter(p => p['Overall Status'] === 'Red').length;
        }

        function populateTeamFilter() {
            const allTeamMembers = new Set();
            projectsData.forEach(project => {
                const members = parseTeamMembers(project['Data People']);
                members.forEach(member => allTeamMembers.add(member));
            });

            const teamFilter = document.getElementById('teamFilter');
            Array.from(allTeamMembers).sort().forEach(member => {
                const option = document.createElement('option');
                option.value = member;
                option.textContent = member;
                teamFilter.appendChild(option);
            });
        }

        function applyFilters() {
            const statusFilter = document.getElementById('statusFilter').value;
            const teamFilter = document.getElementById('teamFilter').value;
            const searchInput = document.getElementById('searchInput').value.toLowerCase();

            filteredProjects = projectsData.filter(project => {
                if (statusFilter && project['Overall Status'] !== statusFilter) return false;
                
                if (teamFilter) {
                    const teamMembers = parseTeamMembers(project['Data People']);
                    if (!teamMembers.includes(teamFilter)) return false;
                }
                
                if (searchInput && !project['Client Name'].toLowerCase().includes(searchInput)) return false;
                
                return true;
            });

            updateStats();
            renderUpcomingMilestones();
            renderProjectsTable();
        }

        document.addEventListener('DOMContentLoaded', () => {
            populateTeamFilter();
            applyFilters();
            
            document.getElementById('lastUpdated').textContent = new Date().toLocaleString();
            
            document.getElementById('statusFilter').addEventListener('change', applyFilters);
            document.getElementById('teamFilter').addEventListener('change', applyFilters);
            document.getElementById('searchInput').addEventListener('input', applyFilters);
        });
    </script>
</body>
</html>

